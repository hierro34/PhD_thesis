\subsection{Continuous formulation}
\label{subsec-variational_continuous}
Let us consider the strong form of the Navier-Stokes problem \Eq{NS_strong_momentum}-\Eq{NS_strong_Ini}. In order to formulate the equivalent variational problem we define a set of variational spaces that incorporates the homogeneous Dirichlet boundary condition and the temporal evolution
\begin{align}
\label{eq-C2_varia_NS_u_space}
&\mathcal{V}_g:=\left\{\v\in\Hbf^1(\Omega):\left.\v\right|_{\Gamma_D}=\u_g\right\}\equiv\Hbf^1_g(\Omega),\\
\label{eq-C2_varia_NS_v_space}
&\mathcal{V}_0:=\left\{\v\in\Hbf^1(\Omega):\left.\v\right|_\Gamma=0\right\}\equiv\Hbf^1_0(\Omega),\\
\label{eq-C2_varia_NS_p_space}
&\mathcal{Q}:=\Lbf^2(\Omega)/\mathbb{R}.
\end{align}
Given sufficiently smooth functions $ \v\in\mathcal{V}_0 $ and $ q\in\mathcal{Q} $, we obtain the variational or weak version of the Navier-Stokes equations multiplying \Eq{NS_strong_momentum} by $ \v $  and \Eq{NS_strong_continuity} by $ q $, integrating over $ \Omega $ and integrating by parts the second order derivatives. Then the variational Navier-Stokes problem reads: find $ \u\in\Lbf^2(0,T;\mathcal{V}_g),\\ $ and $ p\in\Lbf^1(0,T;\mathcal{Q}) $ such that: 
\begin{align}
\label{eq-C2_varia_NS_weak_momentum}
(\partial_t\u,\v)+\left(\nu\left(\nabla\u+\nabla\u^T\right),\nabla\v\right)+b(\u,\u,\v)+(\nabla p,\v)=&\left\langle f,\v\right\rangle&\forall\v\in\mathcal{V}_0,\\
\label{eq-C2_varia_NS_weak_continuity}
(\nabla\cdot\u,q)=&\ 0&\forall q\in\mathcal{Q}.
\end{align}
Adding up equations \Eq{C2_varia_NS_weak_momentum}-\Eq{C2_varia_NS_weak_continuity} we obtain an alternative weak form of the incompressible Navier-Stokes problem \Eq{NS_strong_momentum}-\Eq{NS_strong_Ini} consists, e.g., in finding $[\u,p]\in {L}^2(0,T;\mathcal{V}_g)\times {\cal D}'(0,T;\mathcal{Q})$ (distributions in time with values in $\mathcal{Q}_0$) such that
\begin{equation}
\label{eq-C2_NS_weak}
(\partial_t\u,\v) + B(\u;[\u,p],[\v,q]) = \left<\f,\v\right> 
\quad\quad\forall\v\in\mathcal{V}_0,\quad\forall q\in\mathcal{Q},
\end{equation}
satisfying the initial condition \Eq{NS_strong_Ini} in a weak sense. Here the form $B({\a};[\u,p],(\v,q))$ is defined as 
\begin{equation}
\label{eq-C2_bilinear}
B(\a;[\u,p],[\v,q]):=\nu(\nabla\u,\nabla\v)+b(\a,\u,\v)-(p,\nabla\cdot\v)+(q,\nabla\cdot\u)
\end{equation}
where the trilinear weak form of the convective term $b(\u,\v,\w)$ can be written in the following three equivalent ways
\begin{align}
\label{eq-C2_b_noskew}
&b(\u,\v,\w)=(\u\cdot\nabla\v,\w)&&\mbox{Non conservative},\\
\label{eq-C2_b_skew1}
&b(\u,\v,\mathbf{w})=\frac{1}{2}(\u\cdot\nabla\v,\mathbf{w})-\frac{1}{2}(\v,\u\cdot\nabla\mathbf{w})&&\mbox{Skew-symmetric (type 1)},\\
\label{eq-C2_b_skew2}
&b(\u,\v,\mathbf{w})=(\u\cdot\nabla\v,\mathbf{w})+\frac{1}{2}(\v\cdot\mathbf{w},\nabla\cdot\u)&&\mbox{Skew-symmetric (type 2)}.
\end{align}
Note that in the trilinear weak forms \Eq{C2_b_noskew}-\Eq{C2_b_skew2} the boundary integral terms that arise from the integration by parts have been neglected. This assumtion is valid when strong Dirichlet boundary conditions are considered over all the boundary. Despite of that, this equivalence is lost at the discrete level. The skew-symmetric form (type 2) (\ref{eq-C4_b_skew2}) is very common when numerical analysis are presented \cite{badia_convergence_2014,burman_galerkin_2009,guermond_faedogalerkin_2007} but the skew-symmetric form (type 2) (\ref{eq-C4_b_skew1}) has important advantages when the first argument is a discontinuous function, as will be shown in forthcomming chapters.

The well-posedness of problem \Eq{C2_NS_weak} relies on the called LBB condition, which stands for the name of the authors that developed works related to that condition. See the works by Ladyzhenskaya \cite{ladyzhenskaya1969mathematical}, Babu\^{s}ka \cite{babuska_error-bounds_1971} and Brezzi \cite{brezzi1974existence}. The LBB condition is also called \textit{inf-sup} condition and reads as follows: there exist a positive constant $ \beta $ such that,
\begin{equation}
\label{eq-C2_lbb}
\inf_{q\in\mathcal{Q}}\sup_{\v\in\mathcal{V}_0}\frac{(\nabla\cdot\v,q)}{\|\v\|_\mathcal{V}\|q\|_{\mathcal{Q}/\ker A^t}}\ge\beta>0,
\end{equation}
being $ A^t $ the adjoint of the operator defined as 
\begin{equation}
\label{eq-C2_lbb_operator}
A: \mathcal{V}_0\rightarrow\mathcal{Q'} \quad| \quad\langle A(\v),a\rangle_{\mathcal{Q'}\times\mathcal{Q}}=(\nabla\cdot\v,q)\quad\quad\forall\v\in\mathcal{V}_0,\quad\forall q\in\mathcal{Q}
\end{equation}

\subsection{The Finite Element method}
\label{subsec-variational_finite_element}
In order to approximate the solution of the variational problem \Eq{C2_NS_weak}, one needs to construct finite-dimensional spaces in which the solution can be computed. The approach followed in this work to construct such finite-dimensional spaces is the called Finite Element (FE) method. According to Ciarlet, see \cite{ciarlet_finite_1978}, we can define a finite element as follows.

Let $ K\subseteq\Rbb^n $ be a bounded closed set with nonempty interior and piecewise smooth boundary, the element domain. Let $ \mathcal{S} $ be a finite-dimensional space of functions on $ K $, the space of shape functions. Let $ \mathcal{N}=\{\mathcal{N}_1,\mathcal{N}_2,...,\mathcal{N}_k\} $ be a basis for $ \mathcal{S}' $, the set of nodal variables. Then, $ (K,\mathcal{S},\mathcal{N}) $ is called a finite element.

We refer to Brenner et al \cite{brenner_mathematical_2007} for a deeper explanation of the finite element definitions.

In this thesis we will mainly use FE spaces composed by quadrilateral finit elements built from a tensor product of polynomials. For the 3D case, we consider a reference finite element $ (\widetilde{K},\widetilde{\mathcal{S}},\widetilde{\mathcal{N}}) $ with $ \widetilde{K} $ a cube defined in $ [-1,1]^3 $, $ \widetilde{\mathcal{S}}=Q_k $ being
$$ Q_k:=\left\{\sum_jc_jp_j(x)q_j(y)r_j(z):\mbox{ with $ p_j $, $ q_j $ and $ r_j $ polynomials of degree $j \leq k $}\right\}, $$
and $ \widetilde{\mathcal{N}} $ denoting the point evaluations at $ \left\{(t_l,t_m,t_n):\ l,m,n=0,1,...,k \right\} $ where \\$\left\{-1 = t_0 < t_1 < ... < t_k = 1 \right\}$.

Let us now consider a FE partition $ \mathcal{T}_h $ of the domain $ \Omega $ composed by a set of elements $ \left\{K_e\right\}_{e=1}^{ne} $, being $ ne $ the total amount of elements in the domain. Let us consider $ F_K $ a mapping from $ K $ to $ \widetilde{K} $, i. e. $ F_K(K)=\widetilde{K} $ with its pull-back map defined as $ F^*_K(\hat{f}):=\hat{f}\circ F_K $, see \cite{ciarlet_general_1972,brenner_mathematical_2007} for more details on equivalence between FE.

Then the finite element spaces for the velocity and pressure fields equivalent to \Eq{C2_varia_NS_u_space}-\Eq{C2_varia_NS_p_space} can be defined as
\begin{align}
\label{eq-C2_varia_NS_vh_space}
&\mathcal{V}_{h}:=\left\{\v_h\in(\mathcal{C}^0(\Omega))^d:\left.\v_h\right|_K=\tilde{\v}\circ F_K^{-1},\ \tilde{\v}\in(Q_{k_v})^d,\ K\in\mathcal{T}_h\right\},\\
\label{eq-C2_varia_NS_vgh_space}
&\mathcal{V}_{g,h}:=\left\{\v_h\in\mathcal{V}_h:\left.\v_h\right|_{K\cap\Gamma}=\u_g\right\},\\
\label{eq-C2_varia_NS_v0h_space}
&\mathcal{V}_{0,h}:=\left\{\v_h\in\mathcal{V}_h:\left.\v_h\right|_{\partial K}=0\right\},\\
\label{eq-C2_varia_NS_qh_space}
&\mathcal{Q}_h:=\left\{\mathcal{C}^0(\Omega)\cap\Lbf^2(\Omega)/\mathbb{R}:\left.q_h\right|_K=\tilde{q}\circ F_K^{-1},\ \tilde{q}\in Q_{kq},\ K\in\mathcal{T}_h \right\}.
\end{align}
Where $ k_v $ and $ k_q $, not necessarily equal, are the degree of the polynomials used to define the interpolation space for the velocity and pressure fields, respectively. In what follows, the subindex $ h $ will denote functions related to the FE space. Note that in this work both velocity and pressure field spaces, $ \mathcal{V}_h $ and $ \mathcal{Q}_h $, are considered to be made by continuous funcitons in the same partition of the domain, $ \mathcal{T}_h $.

\subsection{Semi-discrete formulation}
\label{subsec-variational_semidiscrete}
Let us consider a FE partition $ \mathcal{T}_h $ of the domain $ \Omega $ from which we can construct conforming finite dimensional spaces for the velocity $\mathcal{V}_{g,h}\subset\mathcal{V}_g$, and for the pressure $ \mathcal{Q}_{0,h}\subset\mathcal{Q}_0 $. The spaces $\mathcal{V}_{g,h}$ and $ \mathcal{Q}_{0,h} $ are the ones defined in the previous section, equations \Eq{C2_varia_NS_vgh_space} and \Eq{C2_varia_NS_qh_space} respectively.

The Galerkin FE approximation of \Eq{C2_NS_weak} consists in finding $[\u_h,p_h]\in {L}^2(0,T;\mathcal{V}_{g,h})\times {\cal D}'(0,T;\mathcal{Q}_h)$ such that
\begin{equation}
\label{eq-C2_NS_weak_discrete}
(\partial_t\u_h,\v_h) + B(\u_h;[\u_h,p_h],[\v_h,q_h]) = \left<\f,\v_h\right> 
\quad\quad\forall\v_h\in\mathcal{V}_{0,h},\quad\forall q_h\in\mathcal{Q}_h,
\end{equation}

Problem \Eq{C2_NS_weak_discrete} is well posed if the discrete \textit{inf-sup} condition equivalent to \Eq{C2_lbb} is satisfied. The discrete version reads: there exist a positive constant $ \beta_d $, independent of $ h $, such that,
\begin{equation}
\label{eq-C2_lbb_discrete}
\inf_{q_h\in\mathcal{Q}_h}\sup_{\v_h\in\mathcal{V}_{0,h}} \frac{(\nabla\cdot\v_h,q_h)}{\|\v_h\|_{\mathcal{V}_h}\|q\|_{\mathcal{Q}_h/\ker A_h^t}}\ge\beta_d>0,
\end{equation}
with $ A_h $ the equivalent operator to the one defined in \Eq{C2_lbb_operator}.

