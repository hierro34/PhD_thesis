% INTRODUCTION

\chapter{Introduction}
\label{chap-Introduction}

\section{Motivation}

%Physical phenomena of turbulence
The turbulent phenomena that takes place in fluid flows is one of the most fascinating and, at the same time, challenging problems of classical physics. We can find examples of turbulent flows in many situations of our daily life, from the most known and noticeable like the jets leftover by airplanes in the sky or the flow of a river in the mountains, to the most inconspicuous like the turbulent flow that we generate in the morning cup of coffe. Another peculiarity that makes turbulent flows captivating is the wide range of scales in which it appears, starting from the astrophysics with the turbulent flows developed within the stars, to the turbulence that is observed in the biological cells flow.

Despite all the effords dedicated to understand the turbulent phenomena, this is a classical mathematical physics problem that still remains unsolved to this day. Many physists, mathematicians and engineers have been studying this problem during the 19th and 20th Centuries, and the prediction of turbulent behaviour with a certain degree of reliability is not completely understood yet. Then, apart from the practical utility of a deep understanding of its nature, the study of turbulence is also motivated by its inherent intellectual challenge.

It is said that there are two main motivations to study turbulence, physics and engineering. From the physics point of view, the nature of turbulence must be explored to understand the behaviour of such flows at al levels. On the other hand, from the engineering point of view, there are some problems that have to be solved and a solution to them must be given with the knowledge we have now, although it might be incomplete. As an engineering thesis, the motivation of this work relies on the engineering point of view. The approach will be to contribute in developing novel techniques for the simulation of incompressible turbulent flows, making use of the current knowlege of turbulent flow phenomena.

%CFD as a solution
Analytical solutions of fluid flows can only be obtained under certain restrictions and usually this restrictions can not be satisfied in real applications. Thus, we need other approaches to obtain the solution of a fluid flow different from the analytical description. The numerical solution is an alternative to determine the behaviour of fluid flows, which basically consists on approximate the solution defined over a continuous domain by a discrete solution defined in a finite set of points. This technique is known as Computational Fluid Dynamics (CFD) and it is widely used, both in the engineering and the physics worlds.

As it is depicted in the schematic diagram shown in \Fig{fig-CFD}, we can think that CFD leans on the intersection of three different topics: fluid mechanics, software engineering and physical applications. The fluid mechanics field give the basic knowledge of the physical phenomena that describes the fluid flow motion. The software engineering is needed to build codes able to simulate the fluid flow. Finally, we need the applications that give us the problem to be solved.

\begin{figure}[h!]
	\centering	
	\includegraphics[trim=2cm 9cm 11cm 1cm,clip=true,width=0.7\textwidth]{Figures/Chapter1/CFD_scheme}
	\caption{Topics that conform CFD.}
	\label{fig-CFD}
\end{figure}

%Industrial problems
The CFD is widely used in many disciplines and industries like in the aerospace, automotive, chemical manufacturing, power generation, petroleum exploration, medical research, meteorology or astrophysics. It is a very valuable tool since it let to reductions in the cost of production by reducing the need of physical experimentation, improving the products or optimizing the production processes. In Table \ref{table-CFD_applications} we enumerate some more specific applications of CFD simulations that are very usefull for different disciplines.
\begin{table}[h]
\centering
\begin{tabular}{ll}
\toprule
Field&Application\\
\midrule
\midrule
\multirow{8}{*}{Biomedical}&Heart pumping\\
&Blood flow\\
&Air flow in lungs\\
&Nose and sinus flows\\
&Cell-fluid interface\\
&Artificial organ design\\
&Cardiac valve design\\
&Life support systems\\
\midrule
\multirow{1}{*}{Electronics}&Cooling flow in electronic devices\\
\midrule
\multirow{6}{*}{Aerospace and automotive}&Aerodynamic shape optimization\\
&Aerodynamic loads computation\\
&Turbines\\
&Propulsion systems\\
&Airbag Deployment\\
&In-Cylinder Engine Flow\\
\midrule
\multirow{4}{*}{Energy and power industry}&Heat exchange modeling\\
&Wind turbines blade design\\
&Pulverized coal combustion\\
&Emission of NOx particles\\
\midrule
\multirow{4}{*}{Environmental}&Impact of industrial exhausts\\
&Fire and smoke in buildings and tunnels\\
&Natural ventilation systems design\\
&Meteorology prediction\\
\midrule
\multirow{4}{*}{Civil}&Effect of wind on structures\\
&Water flow in rivers\\
&Water management\\
\bottomrule
\end{tabular}
\caption{CFD applications.}
\label{table-CFD_applications}
\end{table}

There already are CFD codes, both commercial and open source, that have the potential to solve a very broad spectrum of flow problems. However, the developement of computational algorithms for the simulation of turbulent flows is still an open topic. Moreover, the improvement of accuracy, the reduction of computational time and the increase of accessibility are also ongoing objectives in CFD. It is true that the CFD has some limitations, but the economic value of industrial applications has been demonstrated in a variety of industries.

%FE methods as CFD
The simulation of fluid flows relies on the fact that we can define a mathematical model that describes the fluid motion. The governing equations of the fluid dynamics are the Navier-Stokes equations. Then, the CFD basically consists on approximate the solution of these equations. Many approximation techniques can be used to simulate fluid flows, the most common are the Finite Element (FE) method, the Finite Differences (FD) method or the Finite Volume (FV) method. All of them are methods that can approximate the solution of a fluid flow and vary in the way in which the spatial domain is dicretized. 

The FD method is based on the application of a local Taylor expansion to approximate the governing equations, but it can only be applied on a discretization constructed by a network of topological squares or hexahedras, depending on the spatial dimensions. On the other hand, FE and FV methods are not restricted by this condition and are more extended in the CFD world. The FV method is based on the approximation of the average integral value on a reference volume being one of the main strengths the ability to handle discontinuous solutions. Rather than an integral average, the FE method is based on pointwise approximations on a grid. In contraposition to FV, it allows the use of high-order approximations and has a strong mathematical foundation behind.

In this thesis the FE method will be considered to discretize in space the Navier-Stokes equations. In any case, it has to be highlighted that the FV method can be recovered with a particular definition of the FE method.

%Exascale computing
The increasing computing power is one of the points that make not only the CFD, but also the computational mechanics in general, more appealing to solve engineering problems with more and more complexity. In order to take advantage of the continuously growing computational power acquired with the new improvements on super-computers, an advance in software design is imperative. New algorithms need to be designed to be used in the exascale computing environment. 

We understand by exascale computing the capacity of a computing system to perform at least one exaFLOPS ($ 10^{18} $ floating point operations per second). This computing capacity is still far from the current computer power, but many effords are dedicated to achieve this objective, which is expected to be acomplished before 2020. There are many issues in the High Performance Computing (HPC) community to be addressed in order to achieve the exascale goal. Some of them are related to the hardware development, including improvements on processors, memory size, memory bandwidth and energy consumtion. Furthermore, there is the need of software improvement in such a way that exascale computing systems can be fully exploited.

Exascale computing is the key with wich we will be able to perform high-fidelity simulations of real world problems. Such simulations are a great challenge of computational physics and engineering, and can transform the computational science into a fully predictive science.

%Large scale solvers
We still do not know much details about how exascale computing systems will be, but there is a clear priority in what software development refers. This is the definition and implementation of algorithms able to scale in extremely large computing environments (machines of the order of some million-cores). We recall here that an scalable algorithm has the property to have a computational cost proportional to the size of the problem that is being solved. Other numerical issues that are thought to be needed to achieve exascale computations are the use of high-order methods which give more accurate results for a given problem size and the development of adaptive methods, which can improve the efficiency of the simulation.

The application of a FE method to a Partial Differential Equation (PDE) leads to a matricial system of equations that has to be solved using linear algebra tools. The development of large scale FE solvers is accomplished by the use of preconditioners that improve the resolution of such matricial system. The most known algorithmically scalable preconditioners are the MultiGrid (MG) preconditioner and the Domain Decomposition (DD) based preconditioners. Nevertheless, in order to reach extreme scalabilty, the algorithmical scalability of a preconditioner is not a sufficient condition, since an efficient implementation is needed. 

%COMFUS group
The development of algorithms and implementations of scalable preconditioners is a hot topic in the FE field and one of the main concerns of FEMPAR, an open source FE library which name stands for Finite Element Multiphysics PARallel solvers. FEMPAR incorporates all the tools needed for the simulation of multiphysical problems, including the linear algebra methods used by the solver, the FE definition or the integration of the discretized (and linearized) PDEs. The resolution of linear systems in parallel with FEMPAR is based on a DD strategy.

FEMPAR is being developed within the Large Scale Scientific Computing (LSSC) group in the ``Centre Internacional de Mètodes Numèrics en Enginyeria'' (CIMNE), the group in which this thesis has been developed. More precisely, the FEMPAR code was born with the COMFUS project (COMputational techniques for FUSion reaction), which is a Starting Independent Research Grant awarded to Prof. Santiago Badia funded by the European Research Council and is the main financial support of the LSSC group.
 

\section{Thesis objectives}

Keeping the motivations described above in mind, let us define more precisely the main objectives which this thesis want to achieve.

\begin{itemize}
\item {\bf RB-VMS methods as LES models for turbulent incompressible flows}\\
As stated in the motivation, the simulation of turbulent flows is a very challenging task. If all scales of turbulent flows are wanted to be resolved, a Direct Numerical Simulation (DNS) has to be performed. This kind of techniques are extremely expensive and not feasible for practical applications. In order to reduce the computational cost of turbulent flow simulations, a technique which is gaining popularity in the CFD field is the Large Eddy Simulation (LES). LES models allow a reduction of the computational cost, since only large scales of the flow are simulated, while the smallest ones are modeled.

The simulation of fluid flows using the standard Galerkin FE method suffer from two well-known numerical inestabilities. On one hand we have the inestability introduced by the convective term when convection-dominated flows are simulated, which is the case of turbulent flows. On the other hand, the velocity and pressure FE spaces need to satisfy a compatibility condition to guarantee stability. The Variational MultiScale (VMS) method is a framework for the development of stabilization techniques that overcome these two inestabilities. 

One of the aims of this thesis is to assess the suitability of Residual-Based VMS (RB-VMS) methods as LES models for the simulation of incompressible turbulent flows. We will focus on the accuracy of such methods and their computational cost.

\item {\bf Mixed FE formulations for LES of turbulent incompressible flows}\\
Although VMS methods overcome the two inestabilities that arise when simulating turbulent incompressible flows using the Galerkin FE formulation, the usage of mixed FE formulations for the velocity and pressure spaces can lead to stable methods in what the compatibility condition refers. Then, using these FE formultaions, only the convective inestability needs to be controled.

Based on VMS methods, a convection stabilization technique is aimed to be developed. As well as the RB-VMS methods, an assessment of its suitability as a LES model for the simulation of turbulent flows is also a target of this thesis.

\item {\bf High-order FE methods}\\
One of the numerical issues to achieve exascale computations enumerated in the motivation section is the use of high-order methods. For a given number of degrees of freedom, with higher-order discretization schemes the accuracy of the solution is improved. 

It is true that using higher-order methods the resulting system of equations is harder to solve due to the increase of connectivities between degrees of freedom, but the improvement on the results usually worth using them. This is on of the points that this thesis will assess.

The development of \textit{order-agnostic} algorithms is also a goal that will be considered in this work.

\item {\bf High-order time integration methods}\\
It is especially important the accuracy in time integration when resolving turbulent flows. The multiscale behaviour of turbulent flows, also in what refers to the temporal scales, requires an accurate time integration scheme that, with sufficiently small time steps, give proper results.

There are many hig-order time integration schemes that can be used to solve the temporal flow evolution, but we will favour the so called $ \theta- $methods and Runge-Kutta schemes.

The definition of algorithms \textit{order-agnostic} in time is also an objective. In this direction, the usage of Runge-Kutta schemes is appropriate since a parametrizable algorithm can be defined. Then, the order of the time integration scheme is given by the values of such parameters.

\item {\bf Adaptive time integration schemes}\\

\item {\bf Segregation of velocity-pressure}\\

\item {\bf Large scale FE solvers}\\

\item {\bf Scalable solvers}\\

\item {\bf Application}\\
\end{itemize}





The TBMs that wrap the fusion reactor core are a fundamental part of it. These modules not only are the responsible of the shielding that absorb the neutrons that emerge from the plasma, but also are the place where the Tritium is extracted. Tritium is needed to keep the plasma and it can not be found in nature, so its extraction is a key step. One of its design consists on a micro-channel system full of  liquid metal. Because of the magnetic forces that confine the plasma inside the reactor core, this liquid is subjected to the magnetohydrodynamics (MHD) equations.

As said before, these components can not be tested in ITER before 2027. When this occurs, its configuration will not be the same that the needed for the DEMO reactor. Then, the tests done in ITER reactor will mainly be used as a validation of the numerical simulation codes that will be used in the final design of the TBMs for the DEMO reactor.

These conditioning aspects imply that the research on numerical simulations able to reproduce such processes are a key step in the development of the nuclear fusion energy. In this thesis project we will continue the work of the COMFUS group in this line.

The liquid metals are electrical conductors that are subjected to the MHD physical laws, which couple the Navier-Stokes equations with Maxwell equations. These flows have a particular behaviour due to the magnetic effects. For a low magnetic Reynolds, the energy spectra is different of the defined by the classical flow theory. For this reason, it is necessary to \emph{develop numerical models able to simulate the quasi2D turbulence} that appears in these processes.

The stabilized finite element formulation for incompressible MHD, tested in laminar regime, that will be used in this thesis has been proposed recently by the group where this thesis is developed. The main novelty with respect to existent formulations is the use of the same interpolation for the fluid-dynamic and magnetic problems, keeping the optimal convergence. At this point, we want to explore its extension to turbulent cases by the use of Variational MultiScale (VMS) methods. These methods arise as a numerical stabilization techniques, but also model successfully the classical flow turbulence since they introduce numerical dissipation efficiently. Therefore, we firstly will \emph{test these methods in classical turbulent flows} to verify their applicability to a more complex turbulent flows. From this point, we want to apply the same methods to simulate the liquid metal problem, which is influenced by the magnetic field, and reproduce accurately the quasi2D turbulence.

The applications we have in mind are extremely complex and require large computational resources. The largest supercomputers are distributed-memory machines with thousands of cores. It is a very hard task to efficiently run simulation codes on these platforms. It requires excellent implementations and robust solvers, based on efficient preconditioners and Krylov solvers. The COMFUS team is actively working in this area, and the FEMPAR code developed by the team has already proved excellent scalability results up to 30,000 cores. The solvers used by the team combine robust and scalable solvers for symmetric positive definite problems and block-preconditioning. This approach allows to deal with indefinite problems like the Stokes system and fluids at low Reynolds numbers. However, there is still the challenge to scale up nonsymmetric and indefinite problems. In order to do so, we are forced to implement and \emph{develop novel techniques for nonsymmetric problems}.

The team has been actively working on new block preconditioners for inductionless and resistive MHD systems. These preconditioners, based on inexact-block LU factorizations, are used in combination with Krylov methods. Since these preconditioners are computationally intensive, it would be very appealing to use them as solvers instead of preconditioners. This approach, in the frame of resistive MHD has been exploited in \cite{badia_unconditionally_2012}, where the $\theta$ scheme was used for time integration. We plan to develop novel operator splitting methods based on implicit-explicit Runge-Kutta schemes. In particular, we want to \emph{design schemes that split velocity-pressure computations}.

Finally and related to the use of VMS methods, we want to \emph{test the advantages of the symmetric projection stabilization methods} with respect to classical VMS formulations.
%Besides to use these block preconditioners to solve the multiphysic problems, this thesis proposal also expect to use the block preconditioners structure to develop new time integrators which decouples the different physical problem variables. The idea is to take advantage of the Implicit-Explicit (IMEX) time integration technique using a Runge-Kutta scheme and operate with the different blocks to decouple the different physical fields that appears into the problem.
%
%\subsection{Large scale computation}
%As it has been said before, the physical processes that takes place in a nuclear fusion reactor lead to complex systems of equations. Besides the coupling between different physical problems, there also appear several length and time scales, resulting in a multi-scale problems. The way to solve accurately problems with large time scales without having numerical inestabilities and without using a small really time step, is by implicit methods. However, these methods require to solve nonlinear systems at each time-step. Then, there arise the need to use scalable solvers for massivelly parallel computers.
%
%It has to be said that the COMFUS group has an extensive experience in this topic. The code that will be used by the thesis development is designed to be used in distributed computers and it incorporates domain decomposition (DD) methods optimal for large scale problems that can be combined in a natural way with block preconditioners. The scalability of these methods has been proved to be excellent until 4096 CPUs {\color{red}(o mes??)}.
%
%To this end, this thesis project considers:
%\begin{itemize}
%\item {\bf Block preconditioners implementation and computational aspects}. As was said before, the multiphysical problem can be rewritten as a block system, i. e., one block for each unknown of the global problem. The non-diagonal blocks are those which couples the different subproblems. Here, the key decision is how to reorganize the system and subsequently how to define a good approximation to the original matrix, which will be used as a preconditioner. These preconditioners must be spectrally equivalent to the original matrix of the system of equations.
%
%{\color{red}... (Santi, queda alguna cosa a fer en aquest apartat? Em sembla que tot el que vam posar a la proposta de la FPU es lo que ja heu fet amb l'Alberto i el Ramon)}
%
%\item {\bf Domain Decomposition solvers for convection dominated flows}. {\color{red} ... (Aquest apartat no hi era a la proposta FPU, perÃ² l'he posat per mencionar lo del BDDC. Alguna idea per posar aqui?)}
%\end{itemize}

\section{Document structure}
