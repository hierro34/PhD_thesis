% INTRODUCTION

\chapter{Introduction}
\label{chap-Introduction}

\section{Motivation}

%Physical phenomena of turbulence
The turbulent phenomena that takes place in fluid flows is one of the most fascinating and, at the same time, challenging problems of classical physics. We can find examples of turbulent flows in many situations of our daily life, from the most known and noticeable like the jets leftover by airplanes in the sky or the flow of a river in the mountains, to the most inconspicuous like the turbulent flow that we generate in the morning cup of coffe. Another peculiarity that makes turbulent flows captivating is the wide range of scales in which it appears, starting from the astrophysics with the turbulent flows developed within the stars, to the turbulence that is observed in the biological cells flow.

Despite all the effords dedicated to understand the turbulent phenomena, this is a classical mathematical physics problem that still remains unsolved to this day. Many physists, mathematicians and engineers have been studying this problem during the 19th and 20th Centuries, and the prediction of turbulent behaviour with a certain degree of reliability is not completely understood yet. Then, apart from the practical utility of a deep understanding of its nature, the study of turbulence is also motivated by its inherent intellectual challenge.

It is said that there are two main motivations to study turbulence, physics and engineering. From the physics point of view, the nature of turbulence must be explored to understand the behaviour of such flows at al levels. On the other hand, from the engineering point of view, there are some problems that have to be solved and a solution to them must be given with the knowledge we have now, although it might be incomplete. As an engineering thesis, the motivation of this work relies on the engineering point of view. The approach will be to contribute in developing novel techniques for the simulation of incompressible turbulent flows, making use of the current knowlege of turbulent flow phenomena.

%CFD as a solution
Analytical solutions of fluid flows can only be obtained under certain restrictions and usually this restrictions can not be satisfied in real applications. Thus, we need other approaches to obtain the solution of a fluid flow different from the analytical description. The numerical solution is an alternative to determine the behaviour of fluid flows, which basically consists on approximate the solution defined over a continuous domain by a discrete solution defined in a finite set of points. This technique is known as Computational Fluid Dynamics (CFD) and it is widely used, both in the engineering and the physics worlds.

As it is depicted in the schematic diagram shown in \Fig{CFD}, we can think that CFD leans on the intersection of three different topics: fluid mechanics, software engineering and physical applications. The fluid mechanics field give the basic knowledge of the physical phenomena that describes the fluid flow motion. The software engineering is needed to build codes able to simulate the fluid flow. Finally, we need the applications that give us the problem to be solved.

\begin{figure}[h!]
	\centering	
	\includegraphics[trim=2cm 9cm 11cm 1cm,clip=true,width=0.7\textwidth]{Figures/Chapter1/CFD_scheme}
	\caption{Topics that conform CFD.}
	\label{fig-CFD}
\end{figure}

%Industrial problems
The CFD is widely used in many disciplines and industries like in the aerospace, automotive, chemical manufacturing, power generation, petroleum exploration, medical research, meteorology or astrophysics. It is a very valuable tool since it let to reductions in the cost of production by reducing the need of physical experimentation, improving the products or optimizing the production processes. In Table \ref{table-CFD_applications} we enumerate some more specific applications of CFD simulations that are very usefull for different disciplines.
\begin{table}[h]
\centering
\begin{tabular}{ll}
\toprule
Field&Application\\
\midrule
\midrule
\multirow{8}{*}{Biomedical}&Heart pumping\\
&Blood flow\\
&Air flow in lungs\\
&Nose and sinus flows\\
&Cell-fluid interface\\
&Artificial organ design\\
&Cardiac valve design\\
&Life support systems\\
\midrule
\multirow{1}{*}{Electronics}&Cooling flow in electronic devices\\
\midrule
\multirow{6}{*}{Aerospace and automotive}&Aerodynamic shape optimization\\
&Aerodynamic loads computation\\
&Turbines\\
&Propulsion systems\\
&Airbag Deployment\\
&In-Cylinder Engine Flow\\
\midrule
\multirow{4}{*}{Energy and power industry}&Heat exchange modeling\\
&Wind turbines blade design\\
&Pulverized coal combustion\\
&Emission of NOx particles\\
\midrule
\multirow{4}{*}{Environmental}&Impact of industrial exhausts\\
&Fire and smoke in buildings and tunnels\\
&Natural ventilation systems design\\
&Meteorology prediction\\
\midrule
\multirow{4}{*}{Civil}&Effect of wind on structures\\
&Water flow in rivers\\
&Water management\\
\bottomrule
\end{tabular}
\caption{CFD applications.}
\label{table-CFD_applications}
\end{table}

There already are CFD codes, both commercial and open source, that have the potential to solve a very broad spectrum of flow problems. However, the developement of computational algorithms for the simulation of turbulent flows is still an open topic. Moreover, the improvement of accuracy, the reduction of computational time and the increase of accessibility are also ongoing objectives in CFD. It is true that the CFD has some limitations, but the economic value of industrial applications has been demonstrated in a variety of industries.

%FE methods as CFD
The simulation of fluid flows relies on the fact that we can define a mathematical model that describes the fluid motion. The governing equations of the fluid dynamics are the Navier-Stokes equations. Then, the CFD basically consists on approximate the solution of these equations. Many approximation techniques can be used to simulate fluid flows, the most common are the Finite Element (FE) method, the Finite Differences (FD) method or the Finite Volume (FV) method. All of them are methods that can approximate the solution of a fluid flow and vary in the way in which the spatial domain is dicretized. 

The FD method is based on the application of a local Taylor expansion to approximate the governing equations, but it can only be applied on a discretization constructed by a network of topological squares or hexahedras, depending on the spatial dimensions. On the other hand, FE and FV methods are not restricted by this condition and are more extended in the CFD world. The FV method is based on the approximation of the average integral value on a reference volume being one of the main strengths the ability to handle discontinuous solutions. Rather than an integral average, the FE method is based on pointwise approximations on a grid. In contraposition to FV, it allows the use of high-order approximations and has a strong mathematical foundation behind.

In this thesis the FE method will be considered to discretize in space the Navier-Stokes equations. In any case, it has to be highlighted that the FV method can be recovered with a particular definition of the FE method.

%Exascale computing
The increasing computing power is one of the points that make not only the CFD, but also the computational mechanics in general, more appealing to solve engineering problems with more and more complexity. In order to take advantage of the continuously growing computational power acquired with the new improvements on super-computers, an advance in software design is imperative. New algorithms need to be designed to be used in the exascale computing environment. 

We understand by exascale computing the capacity of a computing system to perform at least one exaFLOPs ($ 10^{18} $ floating point operations per second). This computing capacity is still far from the current computer power, but many effords are dedicated to achieve this objective, which is expected to be acomplished before 2020. There are many issues in the High Performance Computing (HPC) community to be addressed in order to achieve the exascale goal. Some of them are related to the hardware development, including improvements on processors, memory size, memory bandwidth and energy consumtion. Furthermore, there is the need of software improvement in such a way that exascale computing systems can be fully exploited.

Exascale computing is the key with wich we will be able to perform high-fidelity simulations of real world problems. Such simulations are a great challenge of computational physics and engineering, and can transform the computational science into a fully predictive science.

%Large scale solvers
We still do not know much details about how exascale computing systems will be, but there is a clear priority in what software development refers. This is the definition and implementation of algorithms able to scale in extremely large computing environments (machines of the order of some million-cores). We recall here that an scalable algorithm has the property to have a computational cost proportional to the size of the problem that is being solved. Other numerical issues that are thought to be needed to achieve exascale computations are the use of high-order methods which give more accurate results for a given problem size and the development of adaptive methods, which can improve the efficiency of the simulation.

The application of a FE method to a Partial Differential Equation (PDE) leads to a matricial system of equations that has to be solved using linear algebra tools. The development of large scale FE solvers is accomplished by the use of preconditioners that improve the resolution of such matricial system. The most known algorithmically scalable preconditioners are the MultiGrid (MG) preconditioner and the Domain Decomposition (DD) based preconditioners. Nevertheless, in order to reach extreme scalabilty, the algorithmical scalability of a preconditioner is not a sufficient condition, since an efficient implementation is needed. 

%COMFUS group
The development of algorithms and implementations of scalable preconditioners is a hot topic in the FE field and one of the main concerns of FEMPAR, an open source FE library which name stands for Finite Element Multiphysics PARallel solvers. FEMPAR incorporates all the tools needed for the simulation of multiphysical problems, including the linear algebra methods used by the solver, the FE definition or the integration of the discretized (and linearized) PDEs. The resolution of linear systems in parallel with FEMPAR is based on a DD strategy.

FEMPAR is being developed within the Large Scale Scientific Computing (LSSC) group in the ``Centre Internacional de Mètodes Numèrics en Enginyeria'' (CIMNE), the group in which this thesis has been developed. More precisely, the FEMPAR code was born with the COMFUS project (COMputational techniques for FUSion reaction), which is a Starting Independent Research Grant awarded to Prof. Santiago Badia funded by the European Research Council and is the main financial support of the LSSC group.
 

\section{Thesis objectives}

Keeping the motivations described above in mind, let us define more precisely the main objectives which this thesis want to achieve.

\begin{itemize}
\item {\bf RB-VMS methods as LES models for turbulent incompressible flows}\\
As stated in the motivation, the simulation of turbulent flows is a very challenging task. If all scales of turbulent flows are wanted to be resolved, a Direct Numerical Simulation (DNS) has to be performed. This kind of techniques are extremely expensive and not feasible for practical applications. In order to reduce the computational cost of turbulent flow simulations, a technique which is gaining popularity in the CFD field is the Large Eddy Simulation (LES). LES models allow a reduction of the computational cost, since only large scales of the flow are simulated, while the smallest ones are modeled.

The simulation of fluid flows using the standard Galerkin FE method suffer from two well-known numerical inestabilities. On one hand we have the inestability introduced by the convective term when convection-dominated flows are simulated, which is the case of turbulent flows. On the other hand, the velocity and pressure FE spaces need to satisfy a compatibility condition to guarantee stability. The Variational MultiScale (VMS) method is a framework for the development of stabilization techniques that overcome these two inestabilities. 

One of the aims of this thesis is to assess the suitability of Residual-Based VMS (RB-VMS) methods as LES models for the simulation of incompressible turbulent flows. We will focus on the accuracy of such methods and their computational cost.

\item {\bf Mixed FE formulations for LES of turbulent incompressible flows}\\
Although VMS methods overcome the two inestabilities that arise when simulating turbulent incompressible flows using the Galerkin FE formulation, the usage of mixed FE formulations for the velocity and pressure spaces can lead to stable methods in what the compatibility condition refers. Then, using these FE formultaions, only the convective inestability needs to be controled.

Based on VMS methods, a convection stabilization technique is aimed to be developed. As well as the RB-VMS methods, an assessment of its suitability as a LES model for the simulation of turbulent flows is also a target of this thesis.

\item {\bf High-order FE methods}\\
One of the numerical issues to achieve exascale computations enumerated in the motivation section is the use of high-order methods. For a given number of degrees of freedom, with higher-order discretization schemes the accuracy of the solution is improved. 

It is true that using higher-order methods the resulting system of equations is harder to solve due to the increase of connectivities between degrees of freedom, but the improvement on the results usually worth using them. This is on of the points that this thesis will assess.

The development of \textit{order-agnostic} algorithms is also a goal that will be considered in this work.

\item {\bf High-order time integration methods}\\
It is especially important the accuracy in time integration when resolving turbulent flows. The multiscale behaviour of turbulent flows, also in what refers to the temporal scales, requires an accurate time integration scheme that, with sufficiently small time steps, give proper results.

There are many hig-order time integration schemes that can be used to solve the temporal flow evolution, but we will favour the so called $ \theta- $methods and Runge-Kutta schemes.

The definition of algorithms \textit{order-agnostic} in time is also an objective. In this direction, the usage of Runge-Kutta schemes is appropriate since a parametrizable algorithm can be defined. Then, the order of the time integration scheme is given by the values of such parameters.

\item {\bf Adaptive time integration schemes}\\
The fluid flow characteristics vary in space, but also in time. That means that a fluid flow can be transformed from laminar to turbulent under ceritain circumstances. Then, for a continuously evolving fluid flow, it is natural to consider continuously evolving algorithms that can accomodate the flow characteristics evolution. 

When talking about the time integration, adaptive time integration schemes may be considered if one wants to adapt the time integration algorithm to the flow evolution. The use of Runge-Kutta based time integration schemes allow an easy implementation of adaptive time stepping techniques, and it is one of the reasons why this kind of methods will be considered in this thesis.

\item {\bf Segregation of velocity and pressure fields}\\
The block-segregation of velocity and pressure fields can be achieved by the use of the popular pressure-correction or fractional-step methods. These methods, as they are understood as a solver instead of preconditioner, introduce an additional splitting error.

One of the goals of this thesis is to define a method that segregates velocity and pressure fields at the time discretization level, without introducing splitting errors.

\item {\bf Large scale and scalable FE solvers}\\
As stated in the motivation, the definition and implementation of algorithms able to scale in extremely large computing environments is one of the requeriments needed to have an exascale computing system. That means to build scalable solvers that guarantee that the computational cost will not increase when more computational resources are used.

In this thesis, the application of FE solvers able to reach extreme scalability is one of the main interests. In particular, the code that will be used by the thesis development is designed to be used in distributed computers and it incorporates DD methods optimal for large scale problems that can be combined in a natural way with block preconditioners.

The solvers used by the team in which this thesis has been developed combine robust and scalable solvers for symmetric positive definite problems and block-preconditioning. This approach allows to deal with indefinite problems like the Stokes system and fluids at low Reynolds numbers. However, there is still the challenge to scale up nonsymmetric and indefinite problems. This issue will be treated by the use of segregated velocity-pressure methods that lead to symmetric positive definite systems to be solved.

When constructing block preconditioners we rely on the fact that the multifield problem (in the sense of having velocities and pressures) can be rewritten as a block system, i. e., one block for each unknown of the global problem. The non-diagonal blocks are those which couples the different subproblems. Here, the key decision is how to reorganize the system and subsequently how to define a good approximation to the original matrix, which will be used as a preconditioner. These preconditioners must be spectrally equivalent to the original matrix of the system of equations.

\item {\bf Application}\\
During the development of this thesis, the real life applications have been considered as a motivation of all the improvements that this work provides. All the previous goals are thought to be necessary to build algorithms able to solve problems faster and more accurately.

Although some of the benchmarks used in this thesis can represent a real-life problem, we aim to apply all the techniques developed in this disertation to a problem with interest on the industry. The turbulent flow around an airfoil could be a clear example of a problem that is being used in the areospatial industry.

Moreover, all the advances induced by this work have been implemented in the FEMPAR code, and they will remain there. As FEMPAR is an open source code, all the code developed to achive the thesis goals will be available for the society in general.


\end{itemize}

\section{Document structure}

This thesis is organized as follows:

In this first chapter (\Chap{Introduction}) we have described the main motivations in which this work has been based, as well as the main specific objectives that have been followed.

In \Chap{Preliminaries}, a general introduction to the FE framework is done. We begin with the description of the governing equations of the fluid flows in \Sec{C2_gov_eq}, where some details on the mathematical description of the physical phenomena of the fluid motion is given. In \Sec{C2_functional_spaces} we introduce some notation about functional spaces that will be used along all the thesis. The variational formulation of the problem is given in \Sec{C2_variational}, where we define the variational form of the problem at the continuous and discrete level and we define the concept of FE. After that, in \Sec{C2_vms} we describe the VMS method, which will be referenced by the core chapters of this thesis. In \Sec{C2_time_integration} a definition of the time integration schemes that are used in the forthcoming chapters is given. To finalize \Chap{Preliminaries}, a short summary of what is contained in that chapter is given in \Sec{C2_conclusions}.

An introduction to the turbulent phenomena is given in \Chap{Turbulence}. A very basic introduction to the physical phenomena that lie behind turbulent flows is given in \Sec{C3_introduction}. More details about isotropic turbulence are given in \Sec{C3_isotropic_turbulence}, including some benchmarks that are used in the core chapters of this thesis. The specific details about wall-bounded turbulent flows are defined in \Sec{C3_wall_bounded}. Finally, a summary of this chapter is given in \Sec{C3_conclusions}.

The assessment of some RB-VMS methods for incompressible turbulent flows is done in \Chap{Rb_VMS}. First, an introduction to the chapter is given in \Sec{C4_introduction}, where a description of the state of the art is presented. The mathematical formulation of the problem is defined in \Sec{C4_prob_statement}. Then, some energy balance statements are analysed in \Sec{C4_energy}, and the final discrete problem to be solved is described in \Sec{C4_discrete}. The results of the numerical experiments for different turbulent benchmarks are given in \Sec{C4_experiments}. Finally, the main contributions of this chapter are summarized in \Sec{C4_conclusions}.

In \Chap{TBT_OSS} we propose a mixed FE formulation with convection stabilization for the simulation of turbulent incompressible flows. An introduction to the state of the art is done in \Sec{C5_introduction}. The problem statement is defined in \Sec{C5_prob_statement}, with a brief description of the Navier-Stokes equations and its weak formulation. After that, description of the VMS framework is introduced in \Sec{C5_VMS_framework}, where apart what we have defined in \Sec{C2_vms}, the formulation of this method for mixed FE methods is analysed. A block-preconditioning technique for the monolithic problem is defined in \Sec{C5_block_precond}. The numerical experiments for different turbulent benchmarks are presented in \Sec{C5_experiments}. To sum up the chapter, some conclusions are stated in \Sec{C5_conclusions}.

The development of novel Runge-Kutta based algorithms with velocity and presure segregation is described in \Chap{SRK}. We first introduce the state of the art for this chapter in \Sec{C6_introduction}. The problem is briefly stated in \Sec{C6_prob_statement}. After that, a detailed description of the segregated Runge-Kutta time integration schemes is given in \Sec{C6_SRK_developement}. Some numerical experiments are carried out in \Sec{C6_experiments} and the conclusions are stated in \Sec{C6_conclusions}.

Chapter 7

Chapter 8

Chapter 9, conclusions

Apendices

In order to improve the readability of this document, most of the chapters are self-contained. That means that some notation and definitions can be repeated in several parts of the thesis.