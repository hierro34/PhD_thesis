\chapter{Introduction to turbulence}
\label{chap-Turbulence}
One of the main topics of this thesis is the turbulence phenomena that appear in incompressible fluid flows. In order to put the reader in context, it worth describing the main properties and definitions of such kind of flows, albeit rather briefly. Some of the definitions described in this chapter will be used in further chapters.

\section{Elementary concepts}
In the comming chapters some elmentary conceps will be used. Here we give a brief definition of the most important ones:
\begin{itemize}
\item\keyword{Categories of fluid flow:}\\Fluid mechanics and fluid flows are often divided into different regimes. In particular, one can make three different sub-divisions. The first division distinguishes between fluids that may be treated as inviscid or fluids in where the finite viscosity must be taken into account. The second sub-division distingishes between laminar (organized) and turbulent (chaotic) flow. The final sub-division is between irrotational(or potential) flow and rotational flow.

In this thesis we will mainly focus on the second sub-division, distinguishing between laminar and turbulent flows. Except when stated, the fluid will be considered to be viscous and rotational.

\item\keyword{Newton's law of viscosity}\\In most fluids the shear stress is quantified using an empirical law known as Newton's law of viscosity. This law says that a shear stress, $\tau$, is required to cause relative sliding of the fluid layers. Moreover it states that $\tau$ is directly proportional to the angular distortion rate $\frac{d\gamma}{dt}$. It can be shown that in a one-dimensional flow (being $x$ the flow direction), $ u_x(y) $, $ \frac{d\gamma}{dt}=\frac{\partial u}{\partial y} $. Then the shear stress can be writen as
$$\tau=\rho\nu\frac{\partial u_x}{\partial y},\quad\quad\nu=\frac{\mu}{\rho}.$$
Where $ \nu $ is called the kinematic viscosity.

For two-dimensional flow, Newton's law of viscosity becomes
$$ \tau_{xy}=\rho\nu\left(\frac{\partial u_x}{\partial y}+\frac{\partial u_y}{\partial x}\right). $$

%Shear stresses are important not just because they cause fluid elements to distord, but because an imbalance in shear stress can give rise to a net force on individual fluid elements.

\item\keyword{Reynolds number}\\We define the inertial force of a fluid as the force due to the fluid motion and the viscous force as the force produced by the friction. The visous forces per unit volume have a size: $ f_\nu\sim\frac{\rho\nu|\mathbf{u}|}{l_\bot^2} $, where $ l_\bot^2 $ is a characteristic length scale normal to the streamlines. The inertial forces per unit volume are of the order of: $ f_{in}\sim\frac{\rho |\mathbf{u}|^2}{l} $, where $ l $ is a typical geometric lenght scale. 

We can estimate the ratio between the inertial forces and the viscous forces. This ratio is called \textit{Reynolds number},
$$Re=\frac{\frac{\rho |\mathbf{u}|^2}{l}}{\frac{\rho\nu|\mathbf{u}|}{l_\bot^2}}=\frac{ul}{\nu}.$$

When $ Re $ is small, viscous forces outweight inertial forces (laminar regimes), and when $ Re $ is large, viscous forces are relatively small compared against the inertial ones (turbulent regime).

\item\keyword{Boundary layers}\\ Let us consider a high Reynolds number flow. Since $Re$ is large, we might be tempted to solve the inviscid equations of motion, 
$$(\u\cdot\nabla)\u=-\nabla\left(\frac{p}{\rho}\right)$$
subject to the inviscid boundary condition $\u\cdot dS=0$ on all solid surfaces. This determines the so-called \textit{external problem}. If the fluid satisfies the no-slip condition $\mathbf{u}=0$, there must be some region where the velocity adjust to zero. This region is the called \textit{Boundary Layer}. In this region the only mechanical forces available to cause a drop in velocity are viscous shear stresses. Thus the viscous term must be of the same order as the other terms within the boundary layer, 
$$\nu\Delta\u\sim(\u\cdot\nabla)\u,$$

If the inertial forces are of the same order than the viscous forces in the boundary layer, we can stablish the following relation
\begin{eqnarray*}
f_{in}&\sim& f_\nu\\
\frac{\rho u^2}{l} \sim\frac{\rho\nu u}{\delta^2} &\Rightarrow& \frac{\delta}{l}\sim\left(\frac{ul}{\nu}\right)^{-1/2}=Re^{-1/2},
\end{eqnarray*}
being $\delta$ the size of the boundary layer and $l$ the characteristic domain size. Thus we see that, no matter how small we make $\nu$, there is always some boundary layer where shear stresses are important.

Since $Re$ is large, $\delta\ll l.$ When the boundary layer is so thin, the pressure within a boundary layer is virtually the same as the pressure immediately outside the layer.

Boundary layers have another important characteristic, called \textit{separation}, that occurs when the fluid in the boundary layer is ejected into the external flow and a turbulent wake forms. This separation is caused by the pressure forces. When the adverse pressure gradient ($\nabla p>0$) is big enough, the flow in the boundary layer decelerates and reduces the momentum. Then, the fluid in the boundary layer has less momentum than the corresponding external flow and very quickly it comes to a halt, reverses direction and moves off into the external flow, thus forming a wake.

\item\keyword{Laminar and Turbulent flow:}\\It is an empirical observation that at low values of $Re$ flows are laminar, while at high values of $Re$ they are turbulent (chaotic).

A turbulent flow is charactarised by the fact that, superimposed on the mean flow patern, there is random, chaotic motion. The transition from laminar to turbulent flow occurs because, at certain value of $Re$, inestabilities develop in the laminar flow, usually driven by the inertial forces. At low values of $Re$ these potential inestabilities are damped out by viscoity, while at high values of $Re$ the damping is inadequate.

\end{itemize}

\section{Vorticity}
%%% REVIEW!!!
The vorticity is a measure of the rotation of individual fluid elements and it is defined by the following expresion
$$\omega\cdot d\mathbf{S}=\oint_C\mathbf{u}\cdot d\mathbf{l}.$$
%%%

Vorticity cannot be created within hte interior of a fluid unless there are body forces present, but it spreats by diffusion and can be intensified by streaching of fluid elements. Boundary layers can be thought as diffusion layers for the vorticity generated on a surface.

Sometimes it is more fruitful to work with the vorticity field instead than the velocity field. First, because the rules governing the evolution of $\omega$ are somewhat simpler than those governign $\u$. The second reason is that many flows are characterized by localised regions of intense rotation. When we are interested in rotation, it is natural to focus on angular momentum rather than linear momentum. Operating with the angular momentum, one can obtain an equation describing the vorticity motion, see \cite{Davidson?}.
\begin{equation}
\label{eq-vorticity}
I\frac{D\omega}{Dt}=-\omega\frac{DI}{Dt}+2\nu\mathbf{T}
\end{equation}
where $I$ is the moment of inertia of a small material element that is \textit{instantaneously} spherical and $\nu\mathbf{T}$ denotes the viscous torque acting on the sphere. The equation \Eq{vorticity} suggest several results:
\begin{itemize}
\item $\omega$ evolves indepently of $ p $.
\item If $\omega$ is initially zero, and the flow is inviscid ($ \nu=0 $), then $\omega$ should remain zero in each fluid particle.
\item If $I$ decreases (the vortex is stretching) in a inviscid fluid element, then the vorticity of that element should increase.
\end{itemize}
Alternatively to \Eq{vorticity}, introducing the identity $\nabla(\u^2/2)=(\u\cdot\nabla)\u+\u\times\omega$ into the linear momentum equation \Eq{...} and operating, we obtain another expression of the vorticity motion in terms of the velocity field
\begin{equation}
\label{eq-vorticity_velocity}
\frac{D\omega}{Dt}=(\omega\cdot\nabla)\mathbf{u}+\nu\Delta\omega.
\end{equation}
From \Eq{vorticity} and \Eq{vorticity_velocity} we can easily see that the rate of rotation of a fluid blob may increase or decrease due to changes in its moment of inertia, or changes because it is spun up or slowed down by viscous stresses. We also can state from equation \Eq{vorticity_velocity} that vorticity is advected by $\u$ and diffused by viscous stresses.

Looking at the equation \Eq{vorticity_velocity} we can see that in three-dimensional flows the first term on the right hand side is non-zero. Comparing this equation with the angular momentum equation \Eq{vorticity}, we can say that $(\omega\cdot\nabla)\u$ represents intensification of vorticity by the streaching fluid elements, a justification of this suggestion can be fount in \cite{Pope}.

\section{Reynolds stresses and turbulence models}
It is an empirical observation that if $Re$ is large enough a flow invariably becomes unstable and then turbulent. Suppose we have a turbulent flow in which $\u$ and $p$ consist of a time-averaged component, $\overline{\u}$ and $\overline{p}$, plus a fluctuating part, $\u'$ and $p'$:
$$\u=\overline{\u}+\u',\qquad p=\overline{p}+p'.$$
Taking the $x$-component of the time averaged equation of motion we have that
\begin{eqnarray}
\label{eq-momentum_x}
(\overline{\mathbf{u}}\cdot\nabla)\overline{u}_x=-\frac{\partial}{\partial x}\left(\frac{p}{\rho}\right)+\frac{\partial}{\partial x}\left[2\nu\frac{\partial \overline{u}_x}{\partial x}\right]+\frac{\partial}{\partial y}\left[\nu\left(\frac{\partial \overline{u}_x}{\partial y}+\frac{\partial \overline{u}_y}{\partial x}\right)\right]+\\ \nonumber
+\frac{\partial}{\partial z}\left[\nu\left(\frac{\partial \overline{u}_x}{\partial z}+\frac{\partial \overline{u}_z}{\partial x}\right)\right]+\frac{\partial}{\partial x}[-\overline{u_x'u_x'}]+\frac{\partial}{\partial y}[-\overline{u_x'u_y'}]+\frac{\partial}{\partial z}[-\overline{u_x'u_z'}].
\end{eqnarray}
We determine the laminar stresses from the Newton's law of viscosity, taking into account only the time-averaged components
\begin{eqnarray*}
\sigma_x&=&2\rho\nu\frac{\partial \overline{u}_x}{\partial x},\\
\tau_{xy}&=&\rho\nu\left[\frac{\partial \overline{u}_x}{\partial y}+\frac{\partial \overline{u}_y}{\partial x}\right],\\
\tau_{xz}&=&\rho\nu\left[\frac{\partial \overline{u}_x}{\partial z}+\frac{\partial \overline{u}_z}{\partial z}\right].
\end{eqnarray*}
From \Eq{momentum_x} we see that the turbulent flow have additional stresses that are not considered on the laminar definition. These stresses are called \textit{Reynolds stresses} and are determined by
\begin{eqnarray*}
\sigma_x^R&=&-\rho\overline{u_x'u_x'},\\
\tau_{xy}^R&=&-\rho\overline{u_x'u_y'},\\
\tau_{xz}^R&=&-\rho\overline{u_x'u_z'}.
\end{eqnarray*}
Then, we can rewrite \Eq{momentum_x} in a more compact way:
\begin{equation}
\label{eq-momentum_x_reynolds}
\frac{\partial \bar{u}_x}{\partial t}+(\bar{\mathbf{u}}\cdot\nabla)\bar{u}_x=-\frac{\partial\bar{p}}{\partial x}+\nu\nabla^2\bar{u}_x+(\nabla\cdot\T)_x,
\end{equation}
being
$$\T=\left[\begin{array}{ccc}
\sigma_x^R&\tau_{xy}^R&\tau_{xz}^R\\
\tau_{yx}^R&\sigma_y^R&\tau_{yz}^R\\
\tau_{zx}^R&\tau_{zy}^R&\sigma_z^R
\end{array}\right]$$
the Reynolds stress tensor. If we wish to make predictions from equation \Eq{momentum_x_reynolds} we need to be able to relate the Reynolds stresses, $ -\rho\overline{u_x'u_i'} $, to some quantity which we know about, such as mean velocity gradients of the type $ \frac{\partial\overline{u}_x}{\partial y} $. This is the purpose of \textit{turbulence modelling}. In effect, a turbulence model provides a means of estimating Reynolds stresses.

\subsection{The Closure Problem of Turbulence}
In a turbulent fluid, $\u$ is a chaotic field and vary from one realization of a flow to the next. But the statistical properties of $\u$ seem to be well behaved and perfectly reproducible. It turns out to be possible to manipulate the Navier-Stokes equations into a hierarchy of statistical equations of the form, 
$$\frac{\partial}{\partial t}[\mbox{certain statistical properties of }\mathbf{u}]=f(\mbox{other statistical properties of }\mathbf{u}).$$

It can be shown that this system of equations is not closed, in the sense that, no matter how many manipulations we perform, there are always more statistical unknowns than equations relating them. This is known as the \textit{closure problem of turbulence}, and it arises because of the non-linearity of the Navier-Stokes equations.

\subsection{Reynolds stresses decomposition}
\label{subsubsec:reynolds_decomposition}
Leonard (1974) introduced a decomposition of $\tau_{ij}^R$ into three component stresses.
$$\tau_{ij}^R=L_{ij}+C_{ij}+R_{ij},$$
where $L_{ij}=\overline{\overline{u}_i\overline{u}_j}-\overline{u}_i\overline{u}_j$ are the Leonard stresses. The cross stresses are $C_{ij}=\overline{\overline{u}_iu_j'}+\overline{u_i'\overline{u}_j}$ and finally, $R_{ij}=\overline{u_i'u_j'}$ are the subgrid scale (SGS) Reynolds stresses. Decomposing Reynolds stresses into Leonard, cross and SGS Reynolds stresses we can reformulate \Eq{momentum} as
$$\frac{\partial \overline{\u}}{\partial t}+(\overline{\u}\cdot\nabla)\overline{\u}=-\frac{\partial\overline{p}}{\partial x}+\nu\nabla^2\overline{\u}+\nabla\cdot\L+\nabla\cdot\C+\nabla\cdot\Rbb$$

\section{Definition of some turbulent quantities}
Turbulent flows are considered to be cahotic since, superimposed on the mean flow patern, there appear a fluctuating and random, both in space and time, motion. In general, the simulation of this kind of flows requires a large amount of computational resources. This occurs because the size of spatial and temporal scales needed to accurately reproduce the flow are extremly fine. In order to simplify the simulation, instead of resolving all fluid flow scales, we can simulate the mean flow patern, \textit{i.e.} the largest scales, which in most engineering problems is enough, and consider how the unresolved scales interact with the largest ones taking into account their gross statistical properties. Then, if we want to ensure that the simulation reflects the correct mean flow and the effect of the small scales on the larges is accurately predicted we need some verification tools. These tools are some turbulent quantities that we can evaluate in our simulation and with which we can compare with analytical or more accurate results. In general, these quantities are obtained through an averaging procedure of the fluctuating fluid motion. We define the averaging procedure for a generic quantity $q$ as
$$\left\langle q\right\rangle=\frac{1}{\Pi_{i=1}^{n_d}N_i}\sum_{j_1,...,j_{n_d}}q_{j_1,...,j_{n_d}},$$
that is averaged over $n_d$ dimensions, each dimension $i$ having $N_i$ evaluation points. 

In this section we will briefly define the turbulent quantities that are going to be used to characterize the turbulent flow simulations and that will allow us to compare the results againts the references. We can find a more complete definition of the turbulent quantities that are going to be stated in this section in \cite{orlandi,pope,davidson}.

\begin{itemize}
\item\keyword{Velocity correlation function}\\ The velocity correlation function is defined by
\begin{equation}
\label{eq-velocity_correlation}
Q_{ij}=\left\langle u_i'(\x)u_j'(\x+\r)\right\rangle.
\end{equation}
In general $Q_{ij}$ also depends on time. $Q_{ij}$ tells us about the degree to which, and the manner in which, the velocity components at different points are correlated to each other. However, the velocity correlation function does not, in of itself, tell us how the kinetic energy is distributed across the different eddy sizes. Rather, we must introduce two additional quantities like the second-order structure function and the energy spectrum.
\item\keyword{Second-order structure function}\\ The second-order longitudinal structure function is defined in terms of the longitudinal velocity increment, $\Delta u(r)=u_x(\x+r\hat{\e}_x)-u_x(\x)$, as follows:
\begin{equation}
\label{eq-second_order_structure}
\left\langle[\Delta u(r)]^2\right\rangle=\left\langle[u_x(\x+r\hat{\e}_x)-u_x(\x)]^2\right\rangle.
\end{equation}
Only eddies of size $\sim r$, or less, can make significant contribution to $\Delta u$, and so $\left\langle[\Delta u]^2\right\rangle$ is often taken as an indication of the energy per unit mass contained in the eddies of size $r$ or less. 
\item\keyword{Energy spectrum}\\ To determine the distribution of the kinetic energy among the eddies of different size we look at the energy spectrum function $E(k)$. Working with wave number, $k$, we define the energy spectrum via the transform pair
\begin{align}
\label{eq-energy_spectrum}
E(k)=\frac{2}{\pi}\int_0^\infty R(r)kr\sin(kr)dr,\\
\label{eq-autocovariance}
R(r)=\int_0^\infty E(k)\frac{\sin(kr)}{kr}dk.
\end{align}
Where $R(r)=\frac{1}{2}\left\langle\u(\x)\cdot\u(\x+\r)\right\rangle=u^2(g+f/2)$ is called the autocovariance function. The functions $f$ and $g$ are called the longitudinal and lateral velocity correlation coefficients and satisfy the relation $2rg=(r^2f)'$.

In Appendix \ref{appendix-spectrum_implementation}, some tips for the implementation of the energy spectrum calculation are given.
\item\keyword{Total kinetic energy}\\ Taking the limit $r\rightarrow 0$, the equation \Eq{autocovariance} leads to
\begin{equation}
\label{eq-total_kinetic_energy}
R(0)=\frac{1}{2}\left\langle\u^2\right\rangle=\int_0^\infty E(k)dk,
\end{equation}
which is nothing else than the total kinetic energy, $K:=\frac{1}{2}\left\langle\u^2\right\rangle$. Equation \Eq{total_kinetic_energy} tells us that $E(k)dk$ is the contribution to $K$ from all eddies with wave numbers in the range $k\rightarrow k+dk$, where $k\sim\pi/r$. In fact, it is not true at all, but it works if we are on the range $\eta^{-1}<k<l^{-1}$, being $\eta$ and $l$ the Kolmogorov and integral length scales, respectively, defined in following points.
\item\keyword{Enstrophy}\\ The energy spectrum $E(k)$ has one further property
\begin{equation}
\label{eq-enstrophy}
\left\langle\boldsymbol{\omega}^2\right\rangle=\int_0^\infty k^2E(k)dk.
\end{equation}
If we define the enstrophy as $\Omega:=\frac{1}{2}\left\langle\boldsymbol{\omega}^2\right\rangle$, from \Eq{enstrophy}, the quantity $k^2E(k)$ is interpreted as the contribution to the enstrophy from the range of wave numbers $k\rightarrow k+dk$.
\item\keyword{Skewness factor}\\ The third-order longitudinal structure function is defined, like the second-order longitudinal structure function, as
\begin{equation*}
\label{eq-third_order_structure}
\left\langle[\Delta u(r)]^3\right\rangle=\left\langle[u_x(\x+r\hat{\e}_x)-u_x(\x)]^3\right\rangle.
\end{equation*}
For further discussions, it is more usefull to work with the skewness factor. This factor is a normalized version of the third-order structure function
\begin{equation}
\label{eq-skewness_factor}
S(r)=\frac{\left\langle[\Delta u(r)]^3\right\rangle}{\left\langle[\Delta u(r)]^2\right\rangle^{3/2}}.
\end{equation}
The skewness factor for a decaying turbulent flow depends slightly on the Reynolds number, but usually has a value of around $-0,4\pm0,1$ for $r\rightarrow0$ for $Re$ up to $10^6$, and decays slowly with $r$.
\item\keyword{Root mean square of the velocity field}\\ For a three-dimensional flow, the root mean square (RMS) of the velocity field is given by
$$u=\left(\frac{2}{3}\int_0^\infty E(k)dk\right)^{1/2}.$$
\item\keyword{Integral length scale}\\ $$l=\int_0^\infty fdr=\frac{1}{u^2}\int_0^\infty R\ dr.$$
\item\keyword{Kolmogorov scale}\\$$\eta\sim lRe^{-3/4},\quad\quad\eta\sim\left(\nu^3/\varepsilon\right)^{1/4}.$$
\item\keyword{Taylor microscale}\\$$\lambda^2=\frac{15u^2}{\left\langle\boldsymbol{\omega}^2\right\rangle}=\frac{15\nu u^2}{\varepsilon}.$$
\item\keyword{Taylor-microscale Reynolds number}\\$$Re_\lambda=\frac{u\lambda}{\nu}=\sqrt{15}\frac{u^2}{\left(\nu\varepsilon\right)^{1/2}}=\frac{1}{\nu}\sqrt{\frac{20}{3}}\frac{\int_0^\infty E(k)dk}{\left(\int_0^\infty k^2E(k)dk\right)^{1/2}}.$$
\item\keyword{Energy dissipation rate}\\$$\varepsilon=2\nu\frac{1}{2}\left\langle\boldsymbol{\omega}^2\right\rangle=\frac{15\nu u^2}{\lambda^2}.$$
\end{itemize}

\section{Isotropic turbulence}

\section{Turbulence in wall-bounded flow}

blablabla...
